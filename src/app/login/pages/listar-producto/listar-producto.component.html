<style>
  .custom-card {
  max-width: 100%; /* Asegura que la tarjeta ocupe el 100% del ancho disponible */
  margin: auto; /* Centra la tarjeta horizontalmente */
}

.table-responsive {
  overflow-x: auto; /* Permite el scroll horizontal si es necesario */
}

</style>
<app-header></app-header>
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-12 col-md-10 col-lg-12">
      <div class="card custom-card">
        <div class="card-header">
          Listado de Productos
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Imagen</th>
                  <th>Producto</th>
                  <th>Categoría</th>
                  <th>Marca</th>
                  <th>Descripción</th>
                  <th>Precio</th>
                  <th>Existencias</th>
                  <th>Editar</th>
                  <th>Eliminar</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let producto of productos">
                  <td><img [src]="producto.url" alt="Imagen del producto" class="img-fluid img-thumbnail" style="max-width: 100px;"></td>
                  <td>{{ producto.producto }}</td>
                  <td>{{ producto.categoria }}</td>
                  <td>{{ producto.marca }}</td>
                  <td>{{ producto.descripcion }}</td>
                  <td>{{ producto.precio | currency }}</td>
                  <td>
                    <div class="d-flex flex-column">
                      <input type="number" [(ngModel)]="producto.existencias" class="form-control mb-2">
                      <button class="btn btn-primary btn-sm" (click)="actualizarExistencias(producto)">Actualizar</button>
                    </div>
                  </td>
                  <td>
                    <button class="btn btn-primary btn-sm" (click)="toggleEditForm(producto)">Editar</button>
                  </td>
                  <td>
                    <button class="btn btn-danger btn-sm" (click)="eliminarProducto(producto.id)">Eliminar</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="editarProductoModal" tabindex="-1" aria-labelledby="editarProductoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editarProductoModalLabel">Editar Producto</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="editarForm" (ngSubmit)="guardarProducto()">
          <div class="mb-3">
            <label for="editarFile" class="form-label">Imagen:</label>
            <input formControlName="file" type="file" class="form-control" id="editarFile" (change)="onFileChange($event)">
          </div>
          <div class="mb-3">
            <label for="editarProducto" class="form-label">Producto:</label>
            <input formControlName="producto" type="text" class="form-control" id="editarProducto">
          </div>
          <div class="mb-3">
            <label for="editarCategoria" class="form-label">Categoría:</label>
            <select formControlName="categoria" class="form-select" id="editarCategoria">
              <option value="" disabled>Selecciona una categoría</option>
              <option *ngFor="let categoria of categorias" [value]="categoria.categoria">{{ categoria.categoria }}</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="editarMarca" class="form-label">Marca:</label>
            <select formControlName="marca" class="form-select" id="editarMarca">
              <option value="" disabled>Selecciona una marca</option>
              <option *ngFor="let marca of marcas" [value]="marca.marca">{{ marca.marca }}</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="editarDescripcion" class="form-label">Descripción:</label>
            <textarea formControlName="descripcion" class="form-control" id="editarDescripcion" rows="3"></textarea>
          </div>
          <div class="mb-3">
            <label for="editarPrecio" class="form-label">Precio:</label>
            <input formControlName="precio" type="text" class="form-control" id="editarPrecio">
          </div>
          <div class="mb-3">
            <label for="editarExistencias" class="form-label">Existencias:</label>
            <input formControlName="existencias" type="text" class="form-control" id="editarExistencias">
          </div>
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">Guardar Cambios</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
